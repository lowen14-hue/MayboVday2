<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTFâ€‘8">
<meta name="viewport" content="width=deviceâ€‘width, initialâ€‘scale=1.0">
<title>Macrodata Refinement â€” Vâ€‘Day Edition</title>
<style>
body {
  margin: 0;
  background: #001f4d;
  font-family: monospace;
  overflow: hidden;
}

#bucket {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 22px;
  color: #fff;
  text-shadow: 0 0 4px #0f0;
}

#message {
  position: absolute;
  top: 45%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 32px;
  color: #ff4d6d;
  display: none;
  text-align: center;
}

canvas {
  display: block;
}
</style>
</head>
<body>

<div id="bucket">Found: 0/6</div>
<div id="message">Makaylaâ€¦ will you be my Valentine! ðŸ’Œ</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
<script>
// --- Inspired Macrodata Canvas ---

const sequences = [
  {digits: ['0', '9', '2'], found: 0},
  {digits: ['1', '1', '8'], found: 0},
  {digits: ['2', '0', '5'], found: 0},
  {digits: ['4', '0', '2'], found: 0},
  {digits: ['3', '1', '9'], found: 0},
  {digits: ['5', '8', '3'], found: 0}
];

let grid = [];
const rows = 20, cols = 30;
let cellW, cellH;

function setup() {
  createCanvas(windowWidth, windowHeight);
  textSize(28);
  textAlign(CENTER, CENTER);
  
  cellW = width / cols;
  cellH = height / rows;
  
  for (let y = 0; y < rows; y++) {
    for (let x = 0; x < cols; x++) {
      grid.push({
        x,
        y,
        dx: random(-0.02, 0.02),
        dy: random(-0.02, 0.02),
        val: floor(random(10)),
        matched: false
      });
    }
  }
  
  // Place sequences horizontally
  sequences.forEach(seq => {
    let placed = false;
    while (!placed) {
      let idx = floor(random(grid.length - 3));
      if ((idx % cols) <= (cols - 3)) {
        for (let i = 0; i < 3; i++) {
          let cell = grid[idx + i];
          cell.val = seq.digits[i];
          cell.code = seq;
          cell.matched = true;
        }
        placed = true;
      }
    }
  });
}

function draw() {
  background('#001f4d');
  grid.forEach(cell => {
    cell.x += cell.dx;
    cell.y += cell.dy;
    if (cell.x < 0 || cell.x > cols - 1) cell.dx *= -1;
    if (cell.y < 0 || cell.y > rows - 1) cell.dy *= -1;
    
    const px = cell.x * cellW + cellW / 2;
    const py = cell.y * cellH + cellH / 2;
    
    const glow = random(2, 4);
    drawingContext.shadowColor = '#0f0';
    drawingContext.shadowBlur = glow;
    
    fill(255);
    text(cell.val, px, py);
  });
}

function mousePressed() {
  let bucket = document.getElementById('bucket');
  grid.forEach(cell => {
    const px = cell.x * cellW + cellW / 2;
    const py = cell.y * cellH + cellH / 2;
    if (cell.matched && dist(mouseX, mouseY, px, py) < cellW / 2) {
      cell.matched = false;
      cell.code.found++;
      
      let fly = createDiv(cell.val);
      fly.style.position = 'absolute';
      fly.style.left = px + 'px';
      fly.style.top = py + 'px';
      fly.style.fontSize = '28px';
      fly.style.color = '#fff';
      fly.style.transition = 'all 0.7s ease';
      document.body.appendChild(fly);
      
      setTimeout(() => {
        let bRect = bucket.getBoundingClientRect();
        fly.style.left = bRect.left + bRect.width / 2 + 'px';
        fly.style.top = bRect.top + 'px';
        fly.style.transform = 'scale(0.6)';
        fly.style.opacity = '0.5';
      }, 10);
      
      setTimeout(() => fly.remove(), 800);
      
      document.body.querySelector('#bucket').innerText = `Found: ${sequences.filter(s => s.found === 3).length}/6`;
      if (sequences.every(s => s.found === 3)) {
        document.getElementById('message').style.display = 'block';
      }
    }
  });
}
</script>

</body>
</html>
